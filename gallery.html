<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery</title>
    <link rel="stylesheet" href="static/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        .gallery-dropdown { margin: 2rem auto 1rem auto; max-width: 400px; text-align:center; }
        .dropdown.is-active .dropdown-menu { display: block; }
        .dropdown-menu { min-width: 320px; }
    </style>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f5f5f5; }
        h1 { margin-bottom: 20px; text-align: center; color: #333; }
        .masonry-container { max-width: 1400px; margin: 0 auto; padding: 0 15px; }
        .masonry-row { display: flex; gap: 20px; margin-bottom: 20px; width: 100%; }
        .masonry-item { background: #fff; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); overflow: hidden; position: relative; cursor: pointer; }
        .masonry-item video { width: 100%; height: 100%; object-fit: cover; display: block; }
        .masonry-item::before { content: "\25B6"; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 48px; color: rgba(255, 255, 255, 0.8); text-shadow: 0 0 10px rgba(0, 0, 0, 0.5); z-index: 15; opacity: 0; transition: opacity 0.3s; pointer-events: none; }
        .masonry-item:hover::before { opacity: 1; }
        .masonry-item.playing::before { display: none; }
        .masonry-item video::-webkit-media-controls-panel { opacity: 0 !important; transition: opacity 0.3s ease; background: transparent !important; background-color: transparent !important; }
        .masonry-item:hover video::-webkit-media-controls-panel { opacity: 1 !important; }
        video::-webkit-media-controls-play-button,
        video::-webkit-media-controls-mute-button,
        video::-webkit-media-controls-volume-slider,
        video::-webkit-media-controls-current-time-display,
        video::-webkit-media-controls-time-remaining-display,
        video::-webkit-media-controls-fullscreen-button,
        video::-webkit-media-controls-toggle-closed-captions-button { color: white !important; text-shadow: 0 0 2px rgba(0, 0, 0, 0.8) !important; }
        .masonry-item.playing video::-webkit-media-controls-panel { opacity: 0 !important; background: transparent !important; }
        .masonry-item.playing:hover video::-webkit-media-controls-panel { opacity: 1 !important; }
        video::-webkit-media-controls-mute-button { visibility: visible !important; }
        video::-webkit-media-controls-enclosure { padding: 0; margin: 0; }
        @-moz-document url-prefix() { .masonry-item video { z-index: 1; } }
        @media (max-width: 992px) { .masonry-row { gap: 15px; } .row-2 { flex-wrap: wrap; } .row-2 .masonry-item { width: calc(50% - 8px) !important; margin-bottom: 15px; } .row-3 { padding: 0 10% !important; } }
        @media (max-width: 768px) { .masonry-row { flex-direction: column; gap: 15px; } .row-1 .masonry-item, .row-2 .masonry-item, .row-3 .masonry-item { width: 100% !important; height: auto !important; } .row-1 .masonry-item, .row-3 .masonry-item { padding-top: 66.67% !important; } .row-2 .masonry-item { padding-top: 150% !important; } .row-3 { padding: 0 !important; } }
    </style>
</head>
<body>
    <div class="gallery-dropdown" style="display:flex; align-items:center; justify-content:center; gap:1em;">
        <span style="font-size:1.1em; color:#444;">Select a song:</span>
        <div class="dropdown" id="musicDropdown">
            <div class="dropdown-trigger">
                <button class="button is-link is-medium" aria-haspopup="true" aria-controls="dropdown-menu" id="dropdownButton">
                    <span id="dropdownLabel">APT. ðŸŽµ</span>
                    <span class="icon is-small" style="margin-left:0.5em; font-size:1.2em;">
                        <i class="fas fa-chevron-down" aria-hidden="true" style="color:#838383;"></i>
                    </span>
                </button>
            </div>
            <div class="dropdown-menu" id="dropdown-menu" role="menu">
                <div class="dropdown-content">
                    <a href="#" class="dropdown-item" data-value="APT">APT. ðŸŽµ</a>
                    <a href="#" class="dropdown-item" data-value="CannotStopFeeling">Can't Stop Feeling ðŸŽµ</a>
                    <a href="#" class="dropdown-item" data-value="Uptownfunk">Uptownfunk ðŸŽµ</a>
                </div>
            </div>
        </div>
    </div>
    <h1 class="title is-3">Dance to <em>APT.</em></h1>
    <div class="masonry-container">
        <!-- Row 1: Landscape + Portrait + Landscape -->
        <div class="masonry-row row-1">
            <div class="masonry-item landscape" id="item-1-1">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/begging_catv2_3x2_seed80.mp4" type="video/mp4">
                </video>
            </div>
            <div class="masonry-item portrait" id="item-1-2">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/cat_dancing_3x2_seed8.mp4" type="video/mp4">
                </video>
            </div>
            <div class="masonry-item landscape" id="item-1-3">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/gpt-4o_capybara.mp4" type="video/mp4">
                </video>
            </div>
        </div>
        <!-- Row 2: Landscape + Portrait + Landscape (same as row 1) -->
        <div class="masonry-row row-2">
            <div class="masonry-item landscape" id="item-2-1">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/gpt-4o_hedgehog.mp4" type="video/mp4">
                </video>
            </div>
            <div class="masonry-item portrait" id="item-2-2">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/gpt-4o_meerkat.mp4" type="video/mp4">
                </video>
            </div>
            <div class="masonry-item landscape" id="item-2-3">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/marmot_dance_3x2_seed86.mp4" type="video/mp4">
                </video>
            </div>
        </div>
        <!-- Row 3: All landscape videos -->
        <div class="masonry-row row-3">
            <div class="masonry-item landscape" id="item-3-1">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/marmot_dance_fun_3x2_seed10.mp4" type="video/mp4">
                </video>
            </div>
            <div class="masonry-item landscape" id="item-3-2">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/penguin_3x2_seed80.mp4" type="video/mp4">
                </video>
            </div>
            <div class="masonry-item landscape" id="item-3-3">
                <video controls controlsList="nofullscreen nodownload" playsinline>
                    <source src="assets/videos/everyone_unique_dance/APT/seaotter_3x2_seed55.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </div>
    <script>
        // Dropdown logic
        const dropdown = document.getElementById('musicDropdown');
        const button = document.getElementById('dropdownButton');
        const label = document.getElementById('dropdownLabel');
        const items = dropdown.querySelectorAll('.dropdown-item');
        const musicToUrl = {
            'APT': 'gallery.html',
            'CannotStopFeeling': 'assets/videos/everyone_unique_dance/CannotStopFeeling/index.html',
            'Uptownfunk': 'assets/videos/everyone_unique_dance/Uptownfunk/index.html'
        };
        button.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdown.classList.toggle('is-active');
        });
        items.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                label.textContent = this.textContent;
                dropdown.classList.remove('is-active');
                const value = this.getAttribute('data-value');
                if (value === 'APT') {
                    window.location.href = 'gallery.html';
                } else {
                    window.location.href = musicToUrl[value];
                }
            });
        });
        // Close dropdown on outside click
        document.addEventListener('click', function() {
            dropdown.classList.remove('is-active');
        });
        // --- APT Masonry Layout JS ---
        document.addEventListener('DOMContentLoaded', function () {
            function maintainAspectRatios() {
                const container = document.querySelector('.masonry-container');
                const containerWidth = container.clientWidth;
                const gap = 20;
                const rows = ['.row-1', '.row-2'];
                rows.forEach(rowSelector => {
                    const row = document.querySelector(rowSelector);
                    const items = row.querySelectorAll('.masonry-item');
                    const item1 = items[0];
                    const width1 = (containerWidth - (gap * 2)) * 0.4;
                    const height1 = width1 * (2 / 3);
                    const item2 = items[1];
                    const width2 = (containerWidth - (gap * 2)) * 0.2;
                    const height2 = width2 * (3 / 2);
                    const item3 = items[2];
                    const width3 = (containerWidth - (gap * 2)) * 0.4;
                    const height3 = width3 * (2 / 3);
                    item1.style.width = `${width1}px`;
                    item1.style.height = `${height1}px`;
                    item2.style.width = `${width2}px`;
                    item2.style.height = `${height2}px`;
                    item3.style.width = `${width3}px`;
                    item3.style.height = `${height3}px`;
                });
                const row3 = document.querySelector('.row-3');
                const row3Items = row3.querySelectorAll('.masonry-item');
                const width3 = (containerWidth - (gap * 2)) / 3;
                const height3 = width3 * (2 / 3);
                row3Items.forEach(item => {
                    item.style.width = `${width3}px`;
                    item.style.height = `${height3}px`;
                });
            }
            window.addEventListener('load', maintainAspectRatios);
            window.addEventListener('resize', function () {
                setTimeout(maintainAspectRatios, 200);
            });
            setTimeout(maintainAspectRatios, 10);
            // Setup video click handling
            const videoItems = document.querySelectorAll('.masonry-item');
            const allVideos = document.querySelectorAll('video');
            function pauseAllVideos() {
                allVideos.forEach(v => {
                    v.pause();
                    v.parentElement.classList.remove('playing');
                });
            }
            videoItems.forEach(item => {
                const video = item.querySelector('video');
                video.volume = 0.7;
                video.addEventListener('click', function (e) {
                    if (e.target === video) {
                        e.stopPropagation();
                        if (!video.paused) {
                            video.pause();
                            item.classList.remove('playing');
                        } else {
                            pauseAllVideos();
                            video.play().then(() => {
                                item.classList.add('playing');
                            }).catch(error => {
                                console.error("Error playing video:", error);
                            });
                        }
                    }
                });
                video.addEventListener('mouseover', function () {
                    this.controls = true;
                });
                video.addEventListener('play', function () {
                    const parentItem = this.closest('.masonry-item');
                    if (parentItem) {
                        parentItem.classList.add('playing');
                    }
                    setTimeout(() => {
                        if (!parentItem.matches(':hover')) {
                        }
                    }, 2000);
                });
                video.addEventListener('ended', function () {
                    item.classList.remove('playing');
                });
                video.addEventListener('pause', function () {
                    item.classList.remove('playing');
                });
                video.addEventListener('mousedown', function () {
                    this.controls = true;
                });
            });
            let loadedCount = 0;
            allVideos.forEach(video => {
                video.addEventListener('loadedmetadata', function () {
                    loadedCount++;
                    if (loadedCount === allVideos.length) {
                        maintainAspectRatios();
                    }
                });
                if (video.readyState >= 1) {
                    maintainAspectRatios();
                }
            });
            setTimeout(maintainAspectRatios, 500);
        });
    </script>
</body>
</html> 